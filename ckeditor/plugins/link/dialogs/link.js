var update_ckgeditInternalLink,update_ckgeditMediaLink;var fckgInternalInputId,fckgMediaInputId,ckgeditIwikiData,ckgeditIwikiIndex;var ck_m_files_protocol,ckg_dialog;window.onbeforeunload=function(){};CKEDITOR.dialog.add("link",function(b){oDokuWiki_FCKEditorInstance.Lang=b.lang;ck_m_files_protocol=oDokuWiki_FCKEditorInstance.mfiles?["m-files://\u200E","m-files://"]:"";var x=oDokuWiki_FCKEditorInstance.dwiki_doku_base;var R=CKEDITOR.plugins.link;var f=new Object();f.doku_base=new RegExp("^"+x.replace(/\//g,"\\/"),"g");f.media_internal=/lib\/exe\/fetch\.php\/(.*)/;f.media_rewrite_1=/^_media\/(.*)/;f.media_rewrite_1Doku_Base=new RegExp("^"+x+"_media/(.*)");f.media_rewrite_2=/exe\/fetch.php\?media=(.*)/;f.internal_link=/doku.php\?id=(.*)/;f.internal_link_rewrite_2=/doku.php\/(.*)/;f.internal_link_rewrite_1=new RegExp("^"+x+"(?!_media)(.*)");f.samba=/file:\/\/\/\/\/(.*)/;f.interwiki=/^(.*?)oIWIKIo(.*?)cIWIKIc/;f.samba_unsaved=/^\\\\\w+(\\\w.*)/;ckg_dialog=CKEDITOR.dialog;var B;var H={InternalLink:"internal link",LinkText:"Link Text (Optional)",InternalMedia:"internal media",MediaFileLink:"link to media file",SMBLabel:"Samba Share",GetHeadingsLabel:"Get Headings",QStringLabel:"Query String (For example: value_1=1&value_2=2) ",ResetQS:"Reset Query String",NotSetOption:"Not Set",AdvancedInfo:"To create anchors from Dokuwiki headers, click on the Get Headings button, select the header, click OK. You can go back, select a new page and get new headers.",AdvancedTabPrompt:"Use the advanced tab to create page anchors and query strings",SMBExample:"Enter your share as: \\\\Server\\directory\\file",InterWikiLink:"Interwiki Link",InterWikiType:"Interwiki Type",InterwikiPlaceHolder:"Interwiki Replacement Text",InterwikiInfo:"<div style='max-width:350px; white-space: pre-wrap;border:1px solid #cccccc; margin:auto; overflow:auto; padding:4px;line-height:125%;'>Dokuwiki's interwiki links are short-cuts which look like this: <span style='font-weight:600'>[[wp&gt;Shakespeare]]</span>, which will create a link to the English Wikipedia article on Shakespeare.  The <span style='font-weight:600'>wp</span> part designates a link pattern;  the text following the '<span style='font-weight:900'>&gt;</span>' will be inserted into the link, replacing  a place holder, which is enclosed in curly brackets, as in <span style='font-weight:600'>{NAME}</span>. When there is no place holder, the replacement text will be appended to the end of the link.</div>",MediaFileLink:"link to media file"};var r=b.lang.fbrowser?b.lang.fbrowser:H;var j=function(U){if(r[U]&&r[U]!=""){return r[U]}return H[U]};jQuery.ajax(DOKU_BASE+"lib/exe/ajax.php",{data:{call:"iwiki_list"},type:"POST",async:true,dataType:"json",success:function(V,W,U){retv=V;ckgeditIwikiData=retv},error:function(U,W,V){alert(W);alert(V)}});var P=function(){var X=this.getDialog();var Z=X.getContentElement("advanced","internalAnchor").getInputElement().$.id;var U=document.getElementById(Z);var W=X.getContentElement("info","internal").getInputElement().$.id;W=document.getElementById(W).value;if(!W){return}var V={push:function(ab,aa){this.stack[this.Index]=(new Option(ab,aa,false,false));this.Index++},Index:0,stack:undefined,selection:"",ini:function(aa){this.stack=U.options;this.stack.length=0;this.Index=0;this.push(aa,"")}};var Y="dw_id="+W;b.config.jquery.post(b.config.ckedit_path+"get_headers.php",Y,function(ae,aa){if(aa=="success"){var af=decodeURIComponent(ae);if(af.match(/^\s*__EMPTY__\s*$/)){V.ini("No Headers Found");V.selection="";return}V.ini("Headings Menu");var ad=af.split("@@");for(var ac in ad){var ab=ad[ac].split(/;;/);V.push(ab[0],ab[1])}}},"html")};var K=function(V){var W=V;var U=0;var X="dw_id="+encodeURIComponent(V);b.config.jquery.ajax({url:b.config.ckedit_path+"useheading.php",async:true,data:X,type:"POST",dataType:"html",success:function(Y){if(U){alert(Y)}W=decodeURIComponent(Y)},error:function(Y,aa,Z){W=V}});return W};var S=function(){return B};var p;var m=function(){oDokuWiki_FCKEditorInstance.isLocalDwikiBrowser=false;oDokuWiki_FCKEditorInstance.isUrlExtern=false;oDokuWiki_FCKEditorInstance.isDwikiMediaFile=false;var X=this.getDialog(),aa=["urlOptions","anchorOptions","emailOptions","internalOptions","mediaOptions","sambaOptions","interwikiOptions"],Z=this.getValue(),Y=X.definition.getContents("upload"),U=Y&&Y.hidden;X.hidePage("advanced");if(Z=="internal"){oDokuWiki_FCKEditorInstance.isLocalDwikiBrowser=true;X.showPage("advanced")}else{if(Z=="media"){oDokuWiki_FCKEditorInstance.isDwikiMediaFile=true}}if(Z=="url"){oDokuWiki_FCKEditorInstance.isUrlExtern=true;if(!U){X.showPage("upload")}}else{if(!U){X.hidePage("upload")}}for(var W=0;W<aa.length;W++){var V=X.getContentElement("info",aa[W]);if(!V){continue}V=V.getElement().getParent().getParent();if(aa[W]==Z+"Options"){V.show()}else{V.hide()}}X.layout()};var J=/^javascript:/,L=/^mailto:([^?]+)(?:\?(.+))?$/,h=/subject=([^;?:@&=$,\/]*)/,T=/body=([^;?:@&=$,\/]*)/,u=/^#(.*)$/,c=/^((?:http|https|ftp|news|m-files):\/\/)?(.*)$/,v=/^(_(?:self|top|parent|blank))$/,o=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,G=/^javascript:([^(]+)\(([^)]+)\)$/;var q=x.replace("/","/")+"doku.php?id=(.*)$";var a="/"+q+"/";var l=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/;var z=/(?:^|,)([^=]+)=(\d+|yes|no)/gi;var n=function(X,U){var an=(U&&(U.data("cke-saved-href")||U.getAttribute("href")))||"",ab,am,aj,ac,ae={};if((ab=an.match(J))){if(k=="encode"){an=an.replace(o,function(ar,au,at){return"mailto:"+String.fromCharCode.apply(String,au.split(","))+(at&&t(at))})}else{if(k){an.replace(G,function(ay,aA,av){if(aA==I.name){ae.type="email";var az=ae.email={};var at=/[^,\s]+/g,au=/(^')|('$)/g,ar=av.match(at),aB=ar.length,ax,aC;for(var aw=0;aw<aB;aw++){aC=decodeURIComponent(t(ar[aw].replace(au,"")));ax=I.params[aw].toLowerCase();az[ax]=aC}az.address=[az.name,az.domain].join("@")}})}}}if(!ae.type){var ak=U?U.getAttribute("class"):"";if((aj=an.match(u))){ae.type="anchor";ae.anchor={};ae.anchor.name=ae.anchor.id=aj[1]}else{if((am=an.match(L))){var ad=an.match(h),af=an.match(T);ae.type="email";var ah=(ae.email={});ah.address=am[1];ad&&(ah.subject=decodeURIComponent(ad[1]));af&&(ah.body=decodeURIComponent(af[1]))}else{if((ac=an.match(f.media_internal))||(ac=an.match(f.media_rewrite_1))||(ac=an.match(f.media_rewrite_2))||(ac=an.match(f.media_rewrite_1Doku_Base))){ae.type="media";ae.url={};ae.url.protocol="";ae.url.url="";ae.url.selected=ac[1]}else{if((ac=an.match(a))||(ac=an.match(f.internal_link_rewrite_2))||(ac=an.match(f.internal_link_rewrite_1))){ae.type="internal";ae.url={};var W=ac[1].split("=");ae.url.selected=W[1];ae.url.protocol="";ae.url.url=""}else{if(ac=an.match(f.samba)){ae.type="samba";ae.url={};ae.url.url="";ae.url.protocol="";ae.url.selected="\\\\"+ac[1].replace(/\//g,"\\")}else{if(ac=an.match(f.samba_unsaved)){ae.type="samba";ae.url={};ae.url.url="";ae.url.protocol="";ae.url.selected=ac[0]}else{if(ac=an.match(f.interwiki)||ak.match(/interwiki/)){var ai="";if(ac&&ac[2]){ai=decodeURIComponent(ac[2])}ae.url={};p=U.getAttribute("class");var aa=ckg_dialog.getContentElement("info","iwiki_shortcut");var ao=aa.getInputElement().$.id;var ag=document.getElementById(ao);var Z=p.match(/iw_([^\s]+)/);var Y=Z[1].replace(/_/,".");if(!ai){var al=ckgeditIwikiData[Y];al=al.replace(/\{\w+\}$/,"");var V=new RegExp(al+"(.*)");Z=an.match(V);ai=Z[1]}Y=ckgeditIwikiIndex[Y];if(Y){ag.selectedIndex=Y}else{ag.selectedIndex="0"}aa.disable();ae.type="interwiki";ae.url.selected=ai;ae.url.url=ai}else{if(an&&(ac=an.match(c))){ae.type="url";ae.url={};ae.url.protocol=ac[1];ae.url.url=ac[2]}else{ae.type="url"}}}}}}}}}if(U){var aq=U.getAttribute("target");ae.target={};ae.adv={};var ap=this}this._.selectedElement=U;return ae};var C=function(U){if(!U){return}document.getElementById(fckgInternalInputId).disabled=true;document.getElementById(fckgInternalInputId).style.fontWeight="bold";document.getElementById(fckgInternalInputId).style.backgroundColor="#DDDDDD";U=U.replace(/^[\/\:]/,"");U=U.replace(/\//g,":");U=":"+U;document.getElementById(fckgInternalInputId).value=U};update_ckgeditInternalLink=C;var d=function(U){if(!U){return}U=U.replace(/^[\/\:]/,"");U=U.replace(/\//g,":");U=":"+U;document.getElementById(fckgMediaInputId).value=U};update_ckgeditMediaLink=d;var s=function(U){for(i in U){msg=i+"="+U[i];if(!confirm(msg)){break}}};var y=function(V,U){if(U[V]){this.setValue(U[V][this.id]||"")}};var N=function(U){return y.call(this,"target",U)};var M=function(U){return y.call(this,"adv",U)};var Q=function(V,U){if(!U[V]){U[V]={}}U[V][this.id]=this.getValue()||""};var A=function(U){return Q.call(this,"target",U)};var O=function(U){return Q.call(this,"adv",U)};function t(U){return U.replace(/\\'/g,"'")}function D(U){return U.replace(/'/g,"\\$&")}var k=b.config.emailProtection||"";if(k&&k!="encode"){var I={};k.replace(/^([^(]+)\(([^)]+)\)$/,function(U,V,W){I.name=V;I.params=[];W.replace(/[^,\s]+/g,function(X){I.params.push(X)})})}function e(W){var U,V=I.name,aa=I.params,Y,Z;U=[V,"("];for(var X=0;X<aa.length;X++){Y=aa[X].toLowerCase();Z=W[Y];X>0&&U.push(",");U.push("'",Z?D(encodeURIComponent(W[Y])):"","'")}U.push(")");return U.join("")}function w(V){var U,Y=V.length,W=[];for(var X=0;X<Y;X++){U=V.charCodeAt(X);W.push(U)}return"String.fromCharCode("+W.join(",")+")"}function F(V){var U=V.getAttribute("class");return U?U.replace(/\s*(?:cke_anchor_empty|cke_anchor)(?:\s*$)?/g,""):""}var E=b.lang.common,g=b.lang.link;return{title:g.title,minWidth:375,minHeight:250,contents:[{id:"info",label:g.info,title:g.info,elements:[{id:"linkType",type:"select",label:g.type,"default":"url",items:[[g.toUrl,"url"],[j("InternalLink"),"internal"],[j("InternalMedia"),"media"],[g.toEmail,"email"],[j("SMBLabel"),"samba"],[j("InterWikiLink"),"interwiki"]],onChange:m,setup:function(U){if(U.type){this.setValue(U.type)}},commit:function(U){U.type=this.getValue()}},{type:"vbox",id:"urlOptions",children:[{type:"hbox",widths:["25%","75%"],children:[{id:"protocol",type:"select",label:E.protocol,"default":"http://",items:[["http://\u200E","http://"],["https://\u200E","https://"],["ftp://\u200E","ftp://"],["news://\u200E","news://"],ck_m_files_protocol],setup:function(U){if(U.url){this.setValue(U.url.protocol||"")}},commit:function(U){if(!U.url){U.url={}}U.url.protocol=this.getValue()}},{type:"text",id:"url",label:E.url,required:true,onLoad:function(){this.allowOnChange=true},onKeyUp:function(){this.allowOnChange=false;var W=this.getDialog().getContentElement("info","protocol"),U=this.getValue(),V=/^(http|https|ftp|news|m-files):\/\/(?=.)/i,Y=/^((javascript:)|[#\/\.\?])/i;var X=V.exec(U);if(X){this.setValue(U.substr(X[0].length));W.setValue(X[0].toLowerCase())}else{if(Y.test(U)){W.setValue("")}}this.allowOnChange=true},onChange:function(){if(this.allowOnChange){this.onKeyUp()}},validate:function(){var U=this.getDialog();if(U.getContentElement("info","linkType")&&U.getValueOf("info","linkType")!="url"){return true}if(this.getDialog().fakeObj){return true}var V=CKEDITOR.dialog.validate.notEmpty(g.noUrl);return V.apply(this)},setup:function(U){this.allowOnChange=false;if(U.url){this.setValue(U.url.url)}this.allowOnChange=true},commit:function(U){this.onChange();if(!U.url){U.url={}}U.url.url=this.getValue();this.allowOnChange=false}}],setup:function(U){if(!this.getDialog().getContentElement("info","linkType")){this.getElement().show()}}}]},{type:"vbox",id:"internalOptions",children:[{type:"button",id:"browse1",hidden:"true",filebrowser:"info:url",label:E.browseServer},{type:"text",id:"internal",label:j("InternalLink"),required:true,setup:function(U){if(U){if(U.url&&U.url.selected){var V=U.url.selected.replace(/^\:/,"");this.setValue(":"+V)}}}},{type:"text",id:"internal_text",label:j("LinkText"),required:false},{id:"anchorsmsg",type:"html",html:j("AdvancedTabPrompt")}]},{type:"vbox",id:"interwikiOptions",children:[{type:"text",id:"interwiki",label:j("InterwikiPlaceHolder"),required:true,setup:function(U){if(U){if(U.url&&U.url.selected){var V=U.url.selected.replace(/^\:/,"");this.setValue(V)}}},commit:function(U){if(!U.url){U.url={}}U.url.selection=this.getValue()}},{id:"iwiki_shortcut",type:"select",label:j("InterWikiType"),"default":"",items:[["Not Set","Not-Set"]],setup:function(U){if(U.url){this.setValue(U.url.iwiki_shortcut||"")}},commit:function(U){if(!U.url){U.url={}}U.url.iwiki_shortcut=this.getValue()}},{id:"iwikimsg",type:"html",html:j("InterwikiInfo")}]},{type:"vbox",id:"mediaOptions",children:[{type:"button",id:"browse2",filebrowser:"info:url",label:E.browseServer},{type:"text",id:"media",label:j("MediaFileLink"),required:true,setup:function(U){if(U){if(U.url&&U.url.selected){var V=U.url.selected.replace(/^\:/,"");this.setValue(":"+V)}}}}]},{type:"vbox",id:"sambaOptions",children:[{type:"html",id:"smb_msg",html:j("SMBExample")},{type:"text",id:"samba",width:"50",label:j("SMBLabel"),required:true,setup:function(U){if(U.url&&U.url.selected){this.setValue(U.url.selected)}}}]},{type:"vbox",id:"emailOptions",padding:1,children:[{type:"text",id:"emailAddress",label:g.emailAddress,required:true,validate:function(){var U=this.getDialog();if(!U.getContentElement("info","linkType")||U.getValueOf("info","linkType")!="email"){return true}var V=CKEDITOR.dialog.validate.notEmpty(g.noEmail);return V.apply(this)},setup:function(V){if(V.email){this.setValue(V.email.address)}var U=this.getDialog().getContentElement("info","linkType");if(U&&U.getValue()=="email"){this.select()}},commit:function(U){if(!U.email){U.email={}}U.email.address=this.getValue()}},{type:"text",id:"emailSubject",label:g.emailSubject,setup:function(U){if(U.email){this.setValue(U.email.subject)}},commit:function(U){if(!U.email){U.email={}}U.email.subject=this.getValue()}},{type:"textarea",id:"emailBody",label:g.emailBody,rows:3,"default":"",setup:function(U){if(U.email){this.setValue(U.email.body)}},commit:function(U){if(!U.email){U.email={}}U.email.body=this.getValue()}}],setup:function(U){if(!this.getDialog().getContentElement("info","linkType")){this.getElement().hide()}}}]},{id:"upload",label:g.upload,title:g.upload,hidden:true,filebrowser:"uploadButton",elements:[{type:"file",id:"upload",label:E.upload,style:"height:40px",size:29},{type:"fileButton",id:"uploadButton",label:E.uploadSubmit,filebrowser:"info:url","for":["upload","upload"]}]},{id:"advanced",label:g.advanced,title:g.advanced,elements:[{id:"msg",type:"html",html:"<p style='max-width:350px; white-space: pre-wrap;'>"+j("AdvancedInfo")+"</p>"},{id:"internalAnchor",type:"select","default":"",items:[["Not Set",""]],setup:function(U){if(U.hash){this.setValue(U.hash)}},commit:function(U){U.hash=this.getValue()}},{type:"button",id:"getheaders",onClick:P,label:j("GetHeadingsLabel")},{type:"html",html:"<br />"},{type:"text",id:"queryString",label:j("QStringLabel"),setup:function(U){if(U.qstring){this.setValue(U.qstring)}},commit:function(U){U.qstring=this.getValue()}},{type:"button",id:"clearquerystring",onClick:function(){var V=this.getDialog();var W=V.getContentElement("advanced","queryString").getInputElement().$.id;var U=document.getElementById(W);U.value=""},label:j("ResetQS")},{type:"vbox",padding:1,hidden:true,children:[{type:"hbox",widths:["45%","55%"],children:[{type:"text",label:g.cssClasses,"default":"",id:"advCSSClasses",setup:M,commit:O},{type:"text",label:g.charset,"default":"",id:"advCharset",setup:M,commit:O}]}]}]}],onShow:function(){var W=this.getParentEditor(),V=W.getSelection(),U=null;if((U=R.getSelectedLink(W))&&U.hasAttribute("href")){V.selectElement(U)}else{U=null}this.setupContent(n.apply(this,[W,U]))},onOk:function(){var aw=false;var ae=new RegExp(oDokuWiki_FCKEditorInstance.imageUploadAllowedExtensions);var ag={},Z=[],az={},ay=this,ab=this.getParentEditor();this.commitContent(az);var ar=false;var ah="";switch(az.type||"url"){case"media":if(document.getElementById(fckgMediaInputId).value){az.url.url=document.getElementById(fckgMediaInputId).value}az.adv.advTitle=az.url.url;var ax=az.url.url.match(/(\.(\w+))$/);ah=az.url.url.replace(/^:/,"");az.url.url=top.dokuBase+"doku.php?id="+az.url.url;if(ax[1].match(ae)){az.adv.advContentType="linkonly"}else{az.adv.advContentType="other_mime";az.url.url=top.dokuBase+"lib/exe/fetch.php?media="+ah;ar=true}az.adv.advCSSClasses="media mediafile";if(ax){az.adv.advCSSClasses+=" mf_"+ax[2]}var am=(az.url&&az.url.protocol!=undefined)?az.url.protocol:"http://",ac=(az.url&&CKEDITOR.tools.trim(az.url.url))||"";ag["data-cke-saved-href"]=(ac.indexOf("/")===0)?ac:am+ac;break;case"internal":aw=this.getValueOf("info","internal_text");if(!az.url.url){az.url.url=document.getElementById(fckgInternalInputId).value;if(!az.url.url.match(/^:\w+/)){var aB=top.getCurrentWikiNS()+":";aB=aB.replace(/:$/,"");var Y=new RegExp(":?"+aB+":");if(!az.url.url.match(Y)){az.url.url=aB+":"+az.url.url;az.url.url=az.url.url.replace(/\:{2,}/g,":")}}}az.url.url=az.url.url.replace(/^.*?\/data\/pages\//,"");az.url.url=az.url.url.replace(/^\:/,"");az.url.url=":"+az.url.url.replace(/\//g,":");az.adv.advCSSClasses="wikilink1";if(oDokuWiki_FCKEditorInstance.useheading=="y"){az.adv.advTitle=K(az.url.url)}else{az.adv.advTitle=az.url.url}az.url.url=top.dokuBase+"doku.php?id="+az.url.url;if(az.hash){az.url.url+="#"+az.hash}if(az.qstring){az.url.url+="&"+az.qstring}var am=(az.url&&az.url.protocol!=undefined)?az.url.protocol:"http://",ac=(az.url&&CKEDITOR.tools.trim(az.url.url))||"";ag["data-cke-saved-href"]=(ac.indexOf("/")===0)?ac:am+ac;break;case"interwiki":if(p){az.adv.advCSSClasses=p}else{az.adv.advCSSClasses="interwiki iw_"+az.url.iwiki_shortcut}var at=ckgeditIwikiData[az.url.iwiki_shortcut];az.adv.advTitle=az.url.selection;if(az.url.selection){az.url.selection="oIWIKIo"+az.url.selection+"cIWIKIc"}if(at.match(/\{.*?\}/)){az.url.url=ckgeditIwikiData[az.url.iwiki_shortcut].replace(/{.*?}/,az.url.selection)}else{az.url.url=at+az.url.selection}ag["data-cke-saved-href"]=az.url.url;break;case"url":var am=(az.url&&az.url.protocol!=undefined)?az.url.protocol:"http://",ac=(az.url&&CKEDITOR.tools.trim(az.url.url))||"";ag["data-cke-saved-href"]=(ac.indexOf("/")===0)?ac:am+ac;break;case"anchor":var aC=(az.anchor&&az.anchor.name),an=(az.anchor&&az.anchor.id);ag["data-cke-saved-href"]="#"+(aC||an||"");break;case"samba":if(!az.url.url){az.url.url=document.getElementById(S()).value}if(!az.url.url){alert("Missing Samba Url");return false}az.url.protocol="";var am="";ac=(az.url&&CKEDITOR.tools.trim(az.url.url))||"";ag["data-cke-saved-href"]=(ac.indexOf("/")===0)?ac:am+ac;az.adv.advCSSClasses="windows";az.adv.advTitle=az.url.url;break;case"email":var X,ap=az.email,aa=ap.address;switch(k){case"":case"encode":var ad=encodeURIComponent(ap.subject||""),ai=encodeURIComponent(ap.body||"");var af=[];ai&&af.push("body="+ai);ad&&af.push("subject="+ad);af=af.length?"?"+af.join("&"):"";if(k=="encode"){X=["javascript:void(location.href='mailto:'+",w(aa)];af&&X.push("+'",D(af),"'");X.push(")")}else{X=["mailto:",aa,af]}break;default:var ao=aa.split("@",2);ap.name=ao[0];ap.domain=ao[1];X=["javascript:",e(ap)]}ag["data-cke-saved-href"]=X.join("");break}if(az.adv){var aq=function(aD,aE){var aF=az.adv[aD];if(aF){ag[aE]=aF}else{Z.push(aE)}};aq("advId","id");aq("advLangDir","dir");aq("advAccessKey","accessKey");if(az.adv.advName){ag.name=ag["data-cke-saved-name"]=az.adv.advName}else{Z=Z.concat(["data-cke-saved-name","name"])}aq("advLangCode","lang");aq("advTabIndex","tabindex");if(!ar){aq("advTitle","title")}aq("advContentType","type");aq("advCSSClasses","class");aq("advCharset","charset");aq("advStyles","style");aq("advRel","rel")}var aA=ab.getSelection();var al=aA.getSelectedText()?aA.getSelectedText():false;ag.href=ag["data-cke-saved-href"];if(!this._.selectedElement){var W=aA.getRanges(true);if(W.length==1&&W[0].collapsed){var ak=new CKEDITOR.dom.text(az.type=="email"?az.email.address:ag["data-cke-saved-href"],ab.document);W[0].insertNode(ak);W[0].selectNodeContents(ak);aA.selectRanges(W)}if(navigator.userAgent.match(/(Trident|MSIE)/)){var U=ab.document.createElement("a");U.setAttribute("href",ag.href);if(!al&&(az.type=="media"||az.type=="internal")){if(aw){U.setHtml(aw)}else{U.setHtml(az.adv.advTitle)}}else{U.setHtml(aA.getSelectedText())}for(attr in ag){if(attr.match(/href/i)){continue}U.setAttribute(attr,ag[attr])}ab.insertElement(U)}else{var av=new CKEDITOR.style({element:"a",attributes:ag});av.type=CKEDITOR.STYLE_INLINE;av.apply(ab.document)}}else{var V=this._.selectedElement,au=V.data("cke-saved-href"),aj=V.getHtml();if(ar){ag.type="other_mime";ag.title=":"+ah}V.setAttributes(ag);V.removeAttributes(Z);if(az.adv&&az.adv.advName&&CKEDITOR.plugins.link.synAnchorSelector){V.addClass(V.getChildCount()?"cke_anchor":"cke_anchor_empty")}if(au==aj||az.type=="email"&&aj.indexOf("@")!=-1){V.setHtml(az.type=="email"?az.email.address:ag["data-cke-saved-href"])}aA.selectElement(V);delete this._.selectedElement}if(aw){ak.setText(aw)}else{if(ak&&az.adv.advTitle){ak.setText(az.adv.advTitle)}}},onLoad:function(){ckg_iwi_Select_Id_x=this.getContentElement("info","iwiki_shortcut").getInputElement().$.id;var W=function(){if(!ckgeditIwikiData){return}aa();var ab=document.getElementById(ckg_iwi_Select_Id_x);this.stack=ab.options;this.stack.length=0;this.stack[0]=(new Option("Not Set","not-set",false,false));ckgeditIwikiIndex=new Array();var ad=1;for(var ac in ckgeditIwikiData){this.stack[ad]=new Option(ac+" >> "+ckgeditIwikiData[ac],ac,false,false);ckgeditIwikiIndex[ac]=ad;ad++}};var V=setInterval(function(){W()},1000);var aa=function(){clearInterval(V)};oDokuWiki_FCKEditorInstance.isDwikiImage=false;fckgInternalInputId=this.getContentElement("info","internal").getInputElement().$.id;fckgMediaInputId=this.getContentElement("info","media").getInputElement().$.id;B=this.getContentElement("info","samba").getInputElement().$.id;var Y=this.getContentElement("info","iwiki_shortcut").getInputElement().$.id;this.getContentElement("info","media").disable();this.hidePage("advanced");this.showPage("info");ckg_dialog=this;var X=this._.tabs.advanced&&this._.tabs.advanced[0];var U=this;var Z=j("NotSetOption");X.on("focus",function(ac){var ad=U.getContentElement("advanced","internalAnchor").getInputElement().$.id;var ab=document.getElementById(ad);ab.selectedIndex=-1;ab.options.length=0;ab.options[0]=new Option(Z,"",false,false)})},onFocus:function(){var U=this.getContentElement("info","linkType"),V;if(U&&U.getValue()=="url"){V=this.getContentElement("info","url");V.select()}}}});