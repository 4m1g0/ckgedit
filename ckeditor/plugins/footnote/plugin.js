CKEDITOR.plugins.add("footnote",{init:function(a){a.addCommand("footnoteDialog",new CKEDITOR.dialogCommand("footnoteDialog"));var b=a.lang.footnote;if(!b){b=CKEDITOR.lang["default"]["footnote"]}if(!oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj){oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj=new Object();oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.notes=new Array();oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.count=0}a.ui.addButton("Footnotes",{label:b.ToolTip,command:"footnoteDialog",icon:this.path+"images/footnote.png"});CKEDITOR.dialog.add("footnoteDialog",function(c){return{title:b.Title,minWidth:400,minHeight:200,fontSize:"14pt",onShow:function(){},contents:[{id:"general",label:b.Settings,elements:[{type:"html",html:b.Header,},{type:"textarea",id:"contents",label:b.Label_1,validate:CKEDITOR.dialog.validate.notEmpty(b.Validate),commit:function(d){d.contents=this.getValue()},},{type:"hbox",id:"revisions",widths:["15%","30%","2%","53%"],children:[{type:"html",html:b.Label_2,},{type:"text",id:"noteId",maxLength:"9",commit:function(d){d.noteId=this.getValue()},onChange:function(d){},},{type:"html",html:"&nbsp;&nbsp;",},{type:"button",label:b.LoadButtonLabel,id:"id3",onClick:function(){var f=this.getDialog();var g=f.getContentElement("general","noteId").getInputElement().$.id;var d=document.getElementById(g).value;if(d){if(oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.notes[d]){var g=f.getContentElement("general","contents").getInputElement().$.id;var e=document.getElementById(g);e.value=oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.notes[d]}}},}]},]},{id:"info",label:"Info",elements:[{type:"html",html:b.FootNoteInfo,},]},],onOk:function(){var g=this,h={},f=c.document.createElement("sup");this.commitContent(h);if(h.noteId){oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.notes[h.noteId]=h.contents;return}f.setAttribute("class","dwfcknote ");var e=++oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.count;var d="fckgL"+e;f.setAttribute("class","dwfcknote "+d);oDokuWiki_FCKEditorInstance.oinsertHtmlCodeObj.notes[d]=h.contents;f.setHtml(d);c.insertElement(f)}}})}});